<view class="express-page"><view class="header"><text class="title">快递服务</text><view data-event-opts="{{[['tap',[['scanPackage',['$event']]]]]}}" class="scan-btn" bindtap="__e"><text class="btn-icon">🔍</text><text>扫描</text></view></view><view class="search-box"><input class="search-input" type="text" placeholder="输入快递单号或手机号查询" confirm-type="search" data-event-opts="{{[['confirm',[['searchPackage',['$event']]]],['input',[['__set_model',['','searchText','$event',[]]]]]]}}" value="{{searchText}}" bindconfirm="__e" bindinput="__e"/><button data-event-opts="{{[['tap',[['searchPackage',['$event']]]]]}}" class="search-btn" bindtap="__e">查询</button></view><view class="summary-section"><view class="summary-row"><view data-event-opts="{{[['tap',[['filterPackages',['all']]]]]}}" class="summary-item" bindtap="__e"><text class="summary-number">{{$root.g0}}</text><text class="summary-label">全部</text></view><view data-event-opts="{{[['tap',[['filterPackages',['inTransit']]]]]}}" class="summary-item" bindtap="__e"><text class="summary-number">{{inTransitCount}}</text><text class="summary-label">运输中</text></view><view data-event-opts="{{[['tap',[['filterPackages',['arrived']]]]]}}" class="summary-item" bindtap="__e"><text class="summary-number" style="color:#FF8000;">{{arrivedCount}}</text><text class="summary-label">待取件</text></view><view data-event-opts="{{[['tap',[['filterPackages',['completed']]]]]}}" class="summary-item" bindtap="__e"><text class="summary-number">{{completedCount}}</text><text class="summary-label">已签收</text></view></view></view><view class="package-list"><block wx:for="{{filteredPackages}}" wx:for-item="pkg" wx:for-index="__i0__" wx:key="id"><view data-event-opts="{{[['tap',[['showPackageDetail',['$0'],[[['filteredPackages','id',pkg.id]]]]]]]}}" class="package-card" bindtap="__e"><view class="package-header"><view class="courier-info"><image class="courier-icon" src="{{pkg.courierIcon}}" mode="aspectFit"></image><text class="courier-name">{{pkg.courier}}</text></view><view class="{{['status-tag',pkg.statusClass]}}">{{pkg.statusText}}</view></view><view class="package-content"><view class="package-info"><text class="tracking-number">{{pkg.trackingNumber}}</text><text class="package-desc">{{pkg.description}}</text><text class="update-time">{{pkg.updateTime}}</text></view><block wx:if="{{pkg.status==='arrived'}}"><view class="action-area"><button data-event-opts="{{[['tap',[['showPickupCode',['$0'],[[['filteredPackages','id',pkg.id]]]]]]]}}" class="action-btn pickup" catchtap="__e">取件码</button></view></block></view></view></block><block wx:if="{{$root.g1===0}}"><view class="empty-tip"><image class="empty-icon" src="/static/images/empty-box.png" mode="aspectFit"></image><text>暂无相关快递信息</text></view></block></view><block wx:if="{{showDetail}}"><view class="detail-popup"><view class="detail-content"><view class="detail-header"><view class="popup-title">快递详情</view><text data-event-opts="{{[['tap',[['closeDetail',['$event']]]]]}}" class="close-btn" bindtap="__e">×</text></view><view class="courier-row"><image class="detail-courier-icon" src="{{currentPackage.courierIcon}}" mode="aspectFit"></image><text class="detail-courier-name">{{currentPackage.courier}}</text><view class="{{['detail-status',currentPackage.statusClass]}}">{{currentPackage.statusText}}</view></view><view class="detail-info"><view class="detail-item"><text class="detail-label">快递单号</text><text class="detail-value">{{currentPackage.trackingNumber}}</text><text data-event-opts="{{[['tap',[['copyTrackingNumber',['$event']]]]]}}" class="copy-btn" bindtap="__e">复制</text></view><view class="detail-item"><text class="detail-label">物品描述</text><text class="detail-value">{{currentPackage.description}}</text></view><block wx:if="{{currentPackage.status==='arrived'}}"><view class="detail-item"><text class="detail-label">驿站位置</text><text class="detail-value">{{currentPackage.location}}</text></view></block><block wx:if="{{currentPackage.status==='arrived'}}"><view class="detail-item"><text class="detail-label">取件码</text><text class="pickup-code">{{currentPackage.pickupCode}}</text></view></block></view><view class="detail-timeline"><view class="timeline-title">物流轨迹</view><block wx:for="{{currentPackage.trackingInfo}}" wx:for-item="track" wx:for-index="index" wx:key="index"><view class="timeline-item"><view class="{{['timeline-point',(index===0)?'active':'']}}"></view><view class="timeline-content"><text class="timeline-status">{{track.status}}</text><text class="timeline-time">{{track.time}}</text></view></view></block></view><block wx:if="{{currentPackage.status==='arrived'}}"><view class="detail-actions"><button data-event-opts="{{[['tap',[['navigateToPickup',['$event']]]]]}}" class="detail-btn navigate" bindtap="__e"><text class="btn-icon">🧭</text><text>导航取件</text></button><button data-event-opts="{{[['tap',[['setReminder',['$event']]]]]}}" class="detail-btn remind" bindtap="__e"><text class="btn-icon">⏰</text><text>设置提醒</text></button></view></block></view></view></block><block wx:if="{{showPickupCodePopup}}"><view class="pickup-popup"><view class="pickup-content"><view class="pickup-header"><text class="pickup-title">取件码</text><text data-event-opts="{{[['tap',[['closePickupCode',['$event']]]]]}}" class="close-btn" bindtap="__e">×</text></view><view class="code-display"><text class="code">{{currentPackage.pickupCode}}</text><text class="code-tip">向驿站工作人员出示此码</text></view><view class="station-info"><text class="station-name">{{currentPackage.location}}</text><text class="operation-hours">营业时间: 8:00-22:00</text></view><button data-event-opts="{{[['tap',[['navigateToPickup',['$event']]]]]}}" class="pickup-nav-btn" bindtap="__e"><text class="btn-icon">🧭</text><text>{{"导航前往 ("+currentPackage.distance+")"}}</text></button></view></view></block><block wx:if="{{showNavigation}}"><view class="navigation-popup"><view class="navigation-content"><view class="navigation-header"><text class="navigation-title">路线导航</text><text data-event-opts="{{[['tap',[['closeNavigation',['$event']]]]]}}" class="close-btn" bindtap="__e">×</text></view><view class="map-container"><image class="map-image" src="/static/images/campus-map.png" mode="aspectFit"></image><view class="route-info"><text class="route-distance">{{navInfo.distance}}</text><text class="route-time">{{"预计"+navInfo.time+"分钟到达"}}</text></view></view><view class="nav-steps"><block wx:for="{{navInfo.steps}}" wx:for-item="step" wx:for-index="index" wx:key="index"><view class="nav-step"><text class="step-number">{{index+1}}</text><text class="step-instruction">{{step}}</text></view></block></view><view class="nav-actions"><button data-event-opts="{{[['tap',[['startWalking',['$event']]]]]}}" class="nav-action-btn" bindtap="__e">开始导航</button><button data-event-opts="{{[['tap',[['closeNavigation',['$event']]]]]}}" class="nav-action-btn secondary" bindtap="__e">取消</button></view></view></view></block></view>