<view class="laundry-page"><view class="status-card"><view class="status-header"><text class="location-name">图书馆一楼洗衣房</text><view class="distance-info"><uni-icons vue-id="3a83c37c-1" type="location" size="14" color="#666" bind:__l="__l"></uni-icons><text>50m</text></view></view><view class="status-grid"><view class="status-item"><text class="status-number available">12</text><text class="status-label">空闲机器</text></view><view class="status-item"><text class="status-number busy">8</text><text class="status-label">使用中</text></view><view class="status-item"><text class="status-number">5</text><text class="status-label">分钟等待</text></view><view class="status-item"><text class="status-number">￥3</text><text class="status-label">起步价</text></view></view></view><block wx:if="{{recommendedMachine}}"><view class="recommendation-section"><view class="section-header"><text class="section-title">智能推荐</text><text data-event-opts="{{[['tap',[['refreshRecommendation',['$event']]]]]}}" class="refresh-text" bindtap="__e"><uni-icons vue-id="3a83c37c-2" type="refresh" size="14" color="#666" bind:__l="__l"></uni-icons>刷新推荐</text></view><view class="recommendation-card"><view class="machine-info"><image class="machine-image" src="/static/images/washer-large.png" mode="aspectFit"></image><view class="machine-details"><text class="machine-name">{{recommendedMachine.name}}</text><text class="machine-location">{{recommendedMachine.location}}</text><view class="machine-features"><block wx:for="{{recommendedMachine.features}}" wx:for-item="feature" wx:for-index="index" wx:key="index"><text class="feature-tag">{{feature}}</text></block></view></view></view><view class="booking-info"><view class="price-info"><text class="price-amount">{{"￥"+recommendedMachine.price}}</text><text class="price-unit">/次</text></view><button data-event-opts="{{[['tap',[['bookMachine',['$0'],['recommendedMachine']]]]]}}" class="book-btn" bindtap="__e">立即预约</button></view></view></view></block><view class="machines-section"><view class="section-header"><text class="section-title">全部洗衣机</text><view class="filter-options"><text data-event-opts="{{[['tap',[['setFilter',['all']]]]]}}" class="{{['filter-option',currentFilter==='all'?'active':'']}}" bindtap="__e">全部</text><text data-event-opts="{{[['tap',[['setFilter',['available']]]]]}}" class="{{['filter-option',currentFilter==='available'?'active':'']}}" bindtap="__e">空闲</text><text data-event-opts="{{[['tap',[['setFilter',['busy']]]]]}}" class="{{['filter-option',currentFilter==='busy'?'active':'']}}" bindtap="__e">使用中</text></view></view><view class="machines-list"><block wx:for="{{filteredMachines}}" wx:for-item="machine" wx:for-index="index" wx:key="index"><view class="machine-item"><view class="machine-header"><view class="machine-basic"><image class="machine-icon" src="{{machine.image}}" mode="aspectFit"></image><view class="machine-info"><text class="machine-name">{{machine.name}}</text><text class="machine-type">{{machine.type}}</text></view></view><text class="{{['machine-status',machine.statusClass]}}">{{machine.status}}</text></view><view class="machine-body"><view class="machine-details"><view class="detail-item"><uni-icons vue-id="{{'3a83c37c-3-'+index}}" type="location" size="14" color="#666" bind:__l="__l"></uni-icons><text>{{machine.location}}</text></view><block wx:if="{{machine.remainingTime}}"><view class="detail-item"><uni-icons vue-id="{{'3a83c37c-4-'+index}}" type="timer" size="14" color="#666" bind:__l="__l"></uni-icons><text>{{"剩余"+machine.remainingTime+"分钟"}}</text></view></block><view class="detail-item"><uni-icons vue-id="{{'3a83c37c-5-'+index}}" type="medal" size="14" color="#666" bind:__l="__l"></uni-icons><text>{{machine.rating+"分"}}</text></view></view><view class="machine-price"><text class="price-amount">{{"￥"+machine.price}}</text><text class="price-unit">/次</text></view></view><view class="machine-footer"><view class="feature-tags"><block wx:for="{{machine.features}}" wx:for-item="feature" wx:for-index="fIndex" wx:key="fIndex"><text class="feature-tag">{{feature}}</text></block></view><button data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" data-event-params="{{({machine})}}" class="{{['action-btn',machine.status==='空闲'?'available':'busy']}}" bindtap="__e">{{''+(machine.status==='空闲'?'立即预约':'查看详情')+''}}</button></view></view></block></view></view><block wx:if="{{showBookingPopup}}"><view class="booking-popup"><view data-event-opts="{{[['tap',[['cancelBooking',['$event']]]]]}}" class="popup-mask" bindtap="__e"></view><view class="popup-content"><view class="popup-header"><text class="popup-title">预约确认</text><view data-event-opts="{{[['tap',[['cancelBooking',['$event']]]]]}}" class="popup-close" bindtap="__e"><uni-icons vue-id="3a83c37c-6" type="closeempty" size="20" color="#999" bind:__l="__l"></uni-icons></view></view><view class="popup-body"><view class="selected-machine"><image class="machine-icon" src="{{selectedMachine.image}}" mode="aspectFit"></image><view class="machine-info"><text class="machine-name">{{selectedMachine.name}}</text><text class="machine-location">{{selectedMachine.location}}</text></view></view><view class="booking-details"><view class="detail-row"><text class="detail-label">洗衣模式</text><view class="mode-options"><block wx:for="{{washingModes}}" wx:for-item="mode" wx:for-index="index" wx:key="index"><text data-event-opts="{{[['tap',[['selectMode',['$0'],[[['washingModes','',index,'id']]]]]]]}}" class="{{['mode-option',selectedMode===mode.id?'active':'']}}" bindtap="__e">{{''+mode.name+''}}</text></block></view></view><view class="detail-row"><text class="detail-label">预计费用</text><view class="price-detail"><text class="price-amount">{{"￥"+$root.m0}}</text><text class="price-unit">/次</text></view></view><view class="detail-row"><text class="detail-label">支付方式</text><view class="payment-options"><block wx:for="{{paymentMethods}}" wx:for-item="method" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['selectPayment',['$0'],[[['paymentMethods','',index,'id']]]]]]]}}" class="{{['payment-option',selectedPayment===method.id?'active':'']}}" bindtap="__e"><image class="payment-icon" src="{{method.icon}}" mode="aspectFit"></image><text>{{method.name}}</text></view></block></view></view></view><view class="notification-settings"><text class="settings-title">完成提醒</text><view class="notification-options"><checkbox-group data-event-opts="{{[['change',[['updateNotifications',['$event']]]]]}}" bindchange="__e"><label class="notification-option"><checkbox value="sms" checked="{{true}}"></checkbox><text>短信提醒</text></label><label class="notification-option"><checkbox value="wechat" checked="{{true}}"></checkbox><text>微信提醒</text></label></checkbox-group></view></view></view><view class="popup-footer"><button data-event-opts="{{[['tap',[['cancelBooking',['$event']]]]]}}" class="cancel-btn" bindtap="__e">取消</button><button data-event-opts="{{[['tap',[['confirmBooking',['$event']]]]]}}" class="confirm-btn" bindtap="__e">确认预约</button></view></view></view></block></view>