<view class="emergency-page"><view class="emergency-banner"><image class="banner-image" src="/static/images/emergency-banner.png" mode="aspectFill"></image><view class="banner-content"><text class="banner-title">紧急呼救</text><text class="banner-subtitle">一键联系校园紧急救援</text></view></view><view class="location-card"><view class="location-title"><image class="location-icon" src="/static/images/location-pin.png" mode="aspectFit"></image><text>您的当前位置</text></view><block wx:if="{{userLocation.address}}"><view class="location-info"><text class="location-address">{{userLocation.address}}</text><text class="location-coordinates">{{"GPS: "+userLocation.latitude+", "+userLocation.longitude}}</text></view></block><block wx:else><view class="location-info"><text class="location-loading">正在获取位置信息...</text></view></block><button data-event-opts="{{[['tap',[['refreshLocation',['$event']]]]]}}" class="refresh-button" bindtap="__e">刷新位置</button></view><view class="emergency-contacts"><view class="section-title">紧急联系</view><view data-event-opts="{{[['tap',[['makeEmergencyCall',['$event']]]]]}}" class="one-click-call" bindtap="__e"><image class="call-icon" src="/static/images/emergency-call.png" mode="aspectFit"></image><text class="call-text">一键紧急呼叫</text></view><view class="contacts-list"><block wx:for="{{emergencyContacts}}" wx:for-item="contact" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['callContact',['$0'],[[['emergencyContacts','',index]]]]]]]}}" class="contact-item" bindtap="__e"><view class="contact-info"><text class="contact-name">{{contact.name}}</text><text class="contact-title">{{contact.title}}</text><text class="contact-phone">{{contact.phone}}</text></view><view class="contact-call"><image src="/static/images/phone.png" mode="aspectFit"></image></view></view></block></view></view><view class="send-help-request"><view class="section-title">发送求助信息</view><view class="help-options"><block wx:for="{{helpOptions}}" wx:for-item="option" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['sendHelpRequest',['$0'],[[['helpOptions','',index]]]]]]]}}" class="help-option" bindtap="__e"><image class="option-icon" src="{{option.icon}}" mode="aspectFit"></image><text class="option-text">{{option.text}}</text></view></block></view></view><view class="emergency-tips"><view class="section-title">紧急小贴士</view><view class="tips-content"><block wx:for="{{emergencyTips}}" wx:for-item="tip" wx:for-index="index" wx:key="index"><view class="tip-item"><text class="tip-number">{{index+1}}</text><text class="tip-text">{{tip}}</text></view></block></view></view><block wx:if="{{showCallingModal}}"><view class="modal calling-modal"><view class="modal-content"><image class="calling-animation" src="/static/images/calling.gif" mode="aspectFit"></image><text class="calling-text">正在呼叫...</text><text class="calling-name">{{currentCalling.name}}</text><text class="calling-info">已自动发送您的位置信息</text><button data-event-opts="{{[['tap',[['cancelCall',['$event']]]]]}}" class="cancel-call" bindtap="__e">取消</button></view></view></block><block wx:if="{{showSuccessModal}}"><view class="modal success-modal"><view class="modal-content"><image class="success-icon" src="/static/images/call-success.png" mode="aspectFit"></image><text class="success-text">求助信息已发送</text><text class="success-info">救援人员正在赶来，请保持电话畅通</text><button data-event-opts="{{[['tap',[['confirmSuccess',['$event']]]]]}}" class="confirm-button" bindtap="__e">确定</button></view></view></block></view>